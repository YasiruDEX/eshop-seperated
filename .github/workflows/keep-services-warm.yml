name: Keep Render Services Warm

on:
  schedule:
    # Run every 10 minutes
    - cron: '*/10 * * * *'
  # Allow manual trigger
  workflow_dispatch:

jobs:
  ping-services:
    runs-on: ubuntu-latest
    steps:
      - name: Ping All Render Services
        run: |
          echo "ğŸš€ Starting service health checks..."
          
          echo "ğŸ“¡ Pinging API Gateway..."
          curl -f -s https://eshop-api-gateway-g686.onrender.com/gateway-health || echo "âŒ API Gateway failed"
          
          echo "ğŸ” Pinging Auth Service..."
          curl -f -s https://eshop-auth-uq9z.onrender.com/api/health || echo "âŒ Auth Service failed"
          
          echo "ğŸ“¦ Pinging Catalogue Service..."
          curl -f -s -X POST https://eshop-catalogue.onrender.com/products/filter \
            -H "Content-Type: application/json" \
            -d '{"category":"all","limit":1}' || echo "âŒ Catalogue Service failed"
          
          echo "ğŸ›’ Pinging Checkout Service..."
          curl -f -s https://eshop-checkout.onrender.com/cart/health || echo "âŒ Checkout Service failed"
          
          echo "ğŸ“‹ Pinging Order Service..."
          curl -f -s https://eshop-orders.onrender.com/orders/health || echo "âŒ Order Service failed"
          
          echo "ğŸ‘¤ Pinging Customer Service..."
          curl -f -s https://eshop-customer-880k.onrender.com/api/health || echo "âŒ Customer Service failed"
          
          echo "â­ Pinging Review Service..."
          curl -f -s https://eshop-reviews.onrender.com/reviews/health || echo "âŒ Review Service failed"
          
          echo "ğŸ“Š Pinging Inventory Service..."
          curl -f -s https://eshop-inventory.onrender.com/inventory/health || echo "âŒ Inventory Service failed"
          
          echo "âœ… All service health checks completed!"
